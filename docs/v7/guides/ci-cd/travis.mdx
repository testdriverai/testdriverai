---
title: "Travis CI"
description: "Run TestDriver tests in Travis CI"
icon: "circle-check"
---

<Warning>
Travis CI has significantly reduced its free tier. Consider using [GitHub Actions](/v7/guides/ci-cd/github-actions) or [GitLab CI](/v7/guides/ci-cd/gitlab) instead.
</Warning>

## Basic Setup

Create `.travis.yml`:

```yaml
language: node_js
node_js:
  - 18

cache:
  directories:
    - node_modules

env:
  global:
    - secure: "encrypted_api_key_here"

script:
  - npx vitest

after_script:
  - cat test-results/*.log || true
```

## Add API Key

### Using Travis CLI

Install Travis CLI:

```bash
gem install travis
```

Encrypt API key:

```bash
# Login to Travis
travis login --pro

# Encrypt TD_API_KEY
travis encrypt TD_API_KEY="your-api-key" --add env.global
```

This automatically adds the encrypted key to `.travis.yml`:

```yaml
env:
  global:
    - secure: "very_long_encrypted_string"
```

### Using Travis Web UI

1. Go to repository settings on travis-ci.com
2. Find **Environment Variables** section
3. Add variable:
   - Name: `TD_API_KEY`
   - Value: Your API key from [dashboard.testdriver.ai](https://dashboard.testdriver.ai)
   - Display value in build log: **OFF**
4. Click **Add**

## Parallel Tests

Use build matrix for parallel execution:

```yaml
language: node_js
node_js:
  - 18

env:
  global:
    - secure: "encrypted_api_key"
  jobs:
    - SHARD=1/4
    - SHARD=2/4
    - SHARD=3/4
    - SHARD=4/4

cache:
  directories:
    - node_modules

script:
  - npx vitest --shard=$SHARD
```

## Save Dashcam URLs

Extract replay URLs from test output:

```yaml
script:
  - npx vitest 2>&1 | tee test-output.log
  - grep -o 'https://dashcam.testdriver.ai/[a-zA-Z0-9-]*' test-output.log > dashcam-urls.txt || true

after_failure:
  - cat dashcam-urls.txt
```

## Scheduled Builds

Travis doesn't support scheduled builds in config. Configure via web UI:

1. Go to repository settings
2. Find **Cron Jobs** section
3. Click **Add**
4. Branch: `main`
5. Interval: Daily, Weekly, or Monthly
6. Click **Add**

## Multiple Node Versions

Test across Node.js versions:

```yaml
language: node_js
node_js:
  - 16
  - 18
  - 20

cache:
  directories:
    - node_modules

env:
  global:
    - secure: "encrypted_api_key"

script:
  - npx vitest
```

## Conditional Execution

Skip tests on documentation changes:

```yaml
language: node_js
node_js:
  - 18

cache:
  directories:
    - node_modules

env:
  global:
    - secure: "encrypted_api_key"

before_script:
  - |
    if git diff --name-only $TRAVIS_COMMIT_RANGE | grep -qvE '\.md$'; then
      echo "Code changes detected, running tests"
    else
      echo "Only documentation changed, skipping tests"
      exit 0
    fi

script:
  - npx vitest
```

## Retry Failed Tests

Travis doesn't have built-in retry. Use vitest retry:

```javascript
// vitest.config.mjs
export default defineConfig({
  test: {
    retry: 2
  }
});
```

Or wrap command:

```yaml
script:
  - npx vitest || npx vitest || npx vitest
```

## Different OS

Test on Linux and macOS:

```yaml
language: node_js
node_js:
  - 18

os:
  - linux
  - osx

cache:
  directories:
    - node_modules

env:
  global:
    - secure: "encrypted_api_key"

script:
  - npx vitest
```

## Stages

Organize pipeline into stages:

```yaml
language: node_js
node_js:
  - 18

cache:
  directories:
    - node_modules

env:
  global:
    - secure: "encrypted_api_key"

jobs:
  include:
    - stage: install
      script: npm ci
    
    - stage: test
      script: npx vitest
      env: SHARD=1/4
    
    - stage: test
      script: npx vitest
      env: SHARD=2/4
    
    - stage: test
      script: npx vitest
      env: SHARD=3/4
    
    - stage: test
      script: npx vitest
      env: SHARD=4/4

stages:
  - install
  - test
```

## Artifacts

Travis doesn't have built-in artifact storage. Upload to external service:

```yaml
after_success:
  - |
    if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then
      # Upload to S3, GitHub Releases, etc.
      aws s3 cp test-results/ s3://my-bucket/test-results/ --recursive
    fi
```

## Notifications

Configure notifications:

```yaml
notifications:
  email:
    recipients:
      - team@example.com
    on_success: change  # default: change
    on_failure: always  # default: always
  
  slack:
    rooms:
      - secure: "encrypted_slack_webhook"
    on_success: change
    on_failure: always
```

## Timeout

Set script timeout:

```yaml
script:
  - travis_wait 30 npx vitest  # Wait up to 30 minutes
```

## Troubleshooting

### Tests timeout

Default timeout is 10 minutes. Increase:

```yaml
script:
  - travis_wait 30 npx vitest
```

### Build doesn't start

Travis CI free tier has limited capacity. Builds may queue for hours.

### API key not found

Debug environment:

```yaml
before_script:
  - echo "Has TD_API_KEY ${TD_API_KEY:+yes}"
  - node --version
```

## Complete Example

Full-featured configuration:

```yaml
language: node_js
node_js:
  - 18

cache:
  directories:
    - node_modules

env:
  global:
    - secure: "encrypted_api_key_here"
  jobs:
    - SHARD=1/4
    - SHARD=2/4
    - SHARD=3/4
    - SHARD=4/4

before_install:
  - npm install -g npm@latest

install:
  - npm ci

script:
  - npx vitest --shard=$SHARD 2>&1 | tee test-output.log
  - grep -o 'https://dashcam.testdriver.ai/[a-zA-Z0-9-]*' test-output.log > dashcam-urls.txt || true

after_failure:
  - echo "Dashcam URLs:"
  - cat dashcam-urls.txt || true

after_script:
  - cat test-results/*.log || true

notifications:
  email:
    on_success: change
    on_failure: always

branches:
  only:
    - main
    - develop
```

## Migration to GitHub Actions

Travis CI has become less attractive. Here's equivalent GitHub Actions config:

```yaml
# .github/workflows/test.yml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        shard: [1, 2, 3, 4]
    
    steps:
      - uses: actions/checkout@v3
      
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
      
      - run: npm ci
      
      - run: npx vitest --shard=${{ matrix.shard }}/4
        env:
          TD_API_KEY: ${{ secrets.TD_API_KEY }}
      
      - uses: actions/upload-artifact@v3
        if: always()
        with:
          name: test-results
          path: test-results/
```

See [GitHub Actions guide](/v7/guides/ci-cd/github-actions) for details.

## See Also

<CardGroup cols={2}>
  <Card title="CI/CD Overview" icon="arrows-spin" href="/v7/guides/ci-cd/overview">
    CI/CD concepts
  </Card>
  
  <Card title="GitHub Actions" icon="github" href="/v7/guides/ci-cd/github-actions">
    Recommended alternative
  </Card>
  
  <Card title="GitLab CI" icon="gitlab" href="/v7/guides/ci-cd/gitlab">
    Another alternative
  </Card>
  
  <Card title="Travis CI Docs" icon="book" href="https://docs.travis-ci.com/">
    Official docs
  </Card>
</CardGroup>
